/* Bricks Wizard - dark OKLCH tokenized theme */
.efs-bricks-wizard {
	--efs-wizard-border: color-mix(in oklch, var(--efs-white) 15%, transparent);
	--efs-wizard-border-strong: color-mix(in oklch, var(--efs-white) 24%, transparent);
	--efs-wizard-accent-soft: color-mix(in oklch, var(--efs-primary) 18%, transparent);
	--efs-wizard-surface: var(--efs-base-dark);
	--efs-wizard-panel: var(--efs-base-dark);
	--efs-wizard-bg: var(--efs-base-ultra-dark);
	--efs-wizard-success: var(--efs-success);
	--efs-wizard-warning: var(--efs-warning);
	--efs-wizard-danger: var(--efs-danger);
	display: flex;
	flex-direction: column;
	gap: var(--efs-space-l);
	background: var(--efs-base);
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	padding: 32px;
	color: var(--efs-white);
}

.efs-wizard-panels section {
	display: flex;
	flex-direction: column;
	gap: var(--efs-space-l);
}

.efs-bricks-wizard p,
.efs-bricks-wizard h2,
.efs-bricks-wizard h3,
.efs-bricks-wizard h4,
.efs-bricks-wizard label {
	margin: 0;
}

.efs-bricks-wizard .efs-card__header {
	display: grid;
	gap: var(--efs-space-s);
	padding-bottom: var(--efs-space-l);
	border-bottom: 1px solid var(--efs-wizard-border);
}

.efs-bricks-wizard .efs-card__header h2 {
	font-size: 20px;
	font-weight: 600;
	color: var(--efs-white);
}

.efs-bricks-wizard .efs-card__header p {
	font-size: 14px;
	color: color-mix(in oklch, var(--efs-white) 68%, transparent);
	line-height: 1.4;
}

.efs-wizard-progress-chip-container {
	display: flex;
	justify-content: flex-end;
	min-height: 34px;
}

.efs-wizard-steps {
	display: grid;
	grid-template-columns: repeat(5, minmax(0, 1fr));
	gap: var(--efs-space-s);
}

.efs-wizard-step {
	display: inline-flex;
	align-items: center;
	gap: var(--efs-space-s);
	background: var(--efs-wizard-surface);
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	padding: var(--efs-space-s) var(--efs-space-m);
	cursor: default;
	color: color-mix(in oklch, var(--efs-white) 76%, transparent);
}

.efs-wizard-step.is-clickable {
	cursor: pointer;
}

.efs-wizard-step.is-active {
	border-color: var(--efs-primary);
	background: var(--efs-wizard-accent-soft);
	color: var(--efs-white);
}

.efs-wizard-step.is-complete {
	border-color: color-mix(in oklch, var(--efs-wizard-success) 55%, transparent);
	color: var(--efs-white);
}

.efs-wizard-step__number {
	inline-size: 24px;
	block-size: 24px;
	border-radius: 50%;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	background: color-mix(in oklch, var(--efs-base-ultra-dark) 82%, var(--efs-white) 18%);
	font-size: 12px;
	font-weight: 600;
}

.efs-wizard-step.is-active .efs-wizard-step__number {
	background: var(--efs-primary);
	color: var(--efs-base-ultra-dark);
}

.efs-wizard-step.is-complete .efs-wizard-step__number {
	background: var(--efs-wizard-success);
	color: var(--efs-base-ultra-dark);
}

.efs-wizard-step__label {
	font-size: 13px;
	font-weight: 500;
	white-space: nowrap;
}

.efs-wizard-panel {
	display: flex;
	flex-direction: column;
	gap: var(--efs-space-m);
	padding: var(--efs-space-l);
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	background: var(--efs-wizard-panel);
}

.efs-wizard-panel[hidden] {
	display: none !important;
}

.efs-wizard-panel h3 {
	font-size: 16px;
	font-weight: 600;
	color: var(--efs-white);
}

.efs-wizard-panel p {
	font-size: 14px;
	color: color-mix(in oklch, var(--efs-white) 68%, transparent);
	line-height: 1.4;
}

/* Connect step: one heading, one description, key field + actions (Etch-like, no box-in-box) */
.efs-wizard-connect-key {
	display: flex;
	flex-direction: column;
	gap: var(--efs-space-s);
}

.efs-wizard-connect-key textarea {
	width: 100%;
	min-height: 10em;
	padding: 12px;
	background: var(--efs-base-dark);
	border: 1px solid var(--efs-border-color-light);
	border-radius: var(--efs-radius);
	color: var(--efs-neutral-ultra-light);
	font-size: 13px;
	font-family: 'Space Grotesk', sans-serif;
	white-space: pre-wrap;
	word-wrap: break-word;
	overflow-wrap: break-word;
	resize: vertical;
	line-height: 1.4;
}

.efs-wizard-connect-key textarea::placeholder {
	color: var(--efs-neutral-light);
}

.efs-wizard-connect-key textarea:focus {
	outline: none;
	border-color: var(--efs-primary);
	box-shadow: 0 0 0 1px color-mix(in oklch, var(--efs-primary) 70%, transparent);
}

.efs-wizard-loading {
	display: inline-flex;
	align-items: center;
	gap: var(--efs-space-s);
	padding: var(--efs-space-s) var(--efs-space-m);
	margin-bottom: var(--efs-space-s);
	background: var(--efs-base-ultra-dark);
	border: 1px solid var(--efs-primary);
	border-radius: var(--efs-radius);
	box-shadow: 0 0 0 1px color-mix(in oklch, var(--efs-primary) 35%, transparent), 0 0 24px color-mix(in oklch, var(--efs-primary) 18%, transparent);
}

.efs-wizard-loading[hidden] {
	display: none !important;
}

.efs-wizard-loading__spinner {
	width: 20px;
	height: 20px;
	flex-shrink: 0;
	border: 2px solid var(--efs-primary);
	border-top-color: transparent;
	border-radius: 50%;
	animation: efs-wizard-spin 0.8s linear infinite;
}

.efs-wizard-loading__text {
	color: var(--efs-primary);
	font-size: 15px;
	font-weight: 500;
}

.efs-wizard-summary {
	display: grid;
	grid-template-columns: 1fr auto;
	gap: 24px;
	align-items: start;
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	padding: var(--efs-space-m);
	background: color-mix(in oklch, var(--efs-base-dark) 70%, var(--efs-base-ultra-dark));
}

.efs-wizard-summary__content {
	display: grid;
	gap: var(--efs-space-s);
}

.efs-wizard-summary__actions {
	display: flex;
	align-items: flex-start;
}

.efs-wizard-summary__grade {
	font-weight: 600;
}

.efs-wizard-summary__grade.is-green {
	color: var(--efs-wizard-success);
}

.efs-wizard-summary__grade.is-yellow {
	color: var(--efs-wizard-warning);
}

.efs-wizard-summary__grade.is-red {
	color: var(--efs-wizard-danger);
}

.efs-wizard-summary__breakdown {
	display: flex;
	flex-wrap: wrap;
	gap: 14px;
}

.efs-wizard-summary__item {
	display: flex;
	gap: 8px;
	font-size: 13px;
}

.efs-wizard-summary__label {
	color: color-mix(in oklch, var(--efs-white) 68%, transparent);
}

.efs-wizard-summary__value {
	font-weight: 600;
	color: var(--efs-white);
}

.efs-bricks-wizard .efs-wizard-table.widefat,
.efs-bricks-wizard .efs-wizard-table.striped tbody tr,
.efs-bricks-wizard .efs-wizard-table.striped tbody tr:nth-child(odd),
.efs-bricks-wizard .efs-wizard-table.striped tbody tr:nth-child(even) {
	background: var(--efs-base-ultra-dark);
}

.efs-wizard-table-wrap {
	overflow-x: auto;
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	background: var(--efs-base-ultra-dark);
}

.efs-wizard-table {
	min-width: 720px;
	background: var(--efs-base-ultra-dark);
	color: var(--efs-white);
	border-collapse: collapse;
}

.efs-wizard-table th,
.efs-wizard-table td {
	padding: 12px 14px;
	border-bottom: 1px solid var(--efs-wizard-border);
	vertical-align: middle;
}

.efs-wizard-table thead th {
	background: color-mix(in oklch, var(--efs-base-dark) 85%, var(--efs-base));
	color: var(--efs-white);
	font-size: 14px;
	font-weight: 600;
	text-align: left;
	white-space: nowrap;
	border-bottom: 1px solid var(--efs-wizard-border-strong);
}

.efs-wizard-table tbody tr td {
	font-size: 14px;
	background: var(--efs-base-ultra-dark);
	color: var(--efs-white);
}

.efs-wizard-table tbody tr.is-inactive {
	opacity: 0.4;
}

.efs-wizard-table tbody tr.is-active {
	opacity: 1;
}

.efs-wizard-table tbody tr.is-active td:first-child {
	border-left: 3px solid var(--efs-primary);
}

.efs-wizard-table tbody tr:hover td {
	background: color-mix(in oklch, var(--efs-primary) 8%, var(--efs-base-ultra-dark));
}

.efs-wizard-table .efs-col-check {
	text-align: center;
}

.efs-wizard-table select {
	min-width: 170px;
	padding: 8px 12px;
	background: var(--efs-base-ultra-dark);
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	color: var(--efs-white);
	font-size: 14px;
	cursor: pointer;
}

.efs-wizard-table select:hover,
.efs-wizard-table select:focus {
	border-color: var(--efs-primary);
	outline: none;
}

.efs-wizard-table select option {
	background: var(--efs-base-ultra-dark);
	color: var(--efs-white);
}

.efs-wizard-table tbody tr.is-inactive select:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

.efs-wizard-table input[type='checkbox'] {
	width: 18px;
	height: 18px;
	accent-color: var(--efs-primary);
	cursor: pointer;
}

.efs-col-check {
	width: 80px;
}

.efs-media-toggle {
	display: inline-flex;
	align-items: center;
	gap: var(--efs-space-s);
	color: var(--efs-white);
	font-size: 14px;
	cursor: pointer;
}

.efs-media-toggle input[type='checkbox'] {
	width: 18px;
	height: 18px;
	accent-color: var(--efs-primary);
	cursor: pointer;
}

.efs-wizard-message {
	padding: var(--efs-space-s) var(--efs-space-m);
	border-radius: var(--efs-radius);
	border: 1px solid transparent;
	font-size: 13px;
}

.efs-wizard-message.is-error {
	background: color-mix(in oklch, var(--efs-wizard-danger) 20%, transparent);
	border-color: color-mix(in oklch, var(--efs-wizard-danger) 45%, transparent);
	color: color-mix(in oklch, var(--efs-white) 92%, var(--efs-wizard-danger) 8%);
}

.efs-wizard-message.is-success {
	background: color-mix(in oklch, var(--efs-wizard-success) 20%, transparent);
	border-color: color-mix(in oklch, var(--efs-wizard-success) 45%, transparent);
	color: color-mix(in oklch, var(--efs-white) 92%, var(--efs-wizard-success) 8%);
}

.efs-wizard-message.is-warning {
	background: color-mix(in oklch, var(--efs-wizard-warning) 20%, transparent);
	border-color: color-mix(in oklch, var(--efs-wizard-warning) 45%, transparent);
	color: color-mix(in oklch, var(--efs-white) 92%, var(--efs-wizard-warning) 8%);
}

.efs-wizard-preview-list {
	padding-left: 18px;
	display: grid;
	gap: var(--efs-space-xs);
}

.efs-wizard-warnings {
	padding: var(--efs-space-m);
	border-radius: var(--efs-radius);
	border: 1px solid color-mix(in oklch, var(--efs-wizard-warning) 45%, transparent);
	background: color-mix(in oklch, var(--efs-wizard-warning) 14%, transparent);
}

.efs-wizard-warnings[hidden] {
	display: none !important;
}

.efs-wizard-warnings ul {
	padding-left: 18px;
}

.efs-wizard-warnings li.is-error {
	color: color-mix(in oklch, var(--efs-white) 88%, var(--efs-wizard-danger) 12%);
}

.efs-wizard-warnings li.is-warning {
	color: color-mix(in oklch, var(--efs-white) 88%, var(--efs-wizard-warning) 12%);
}

.efs-wizard-warnings li.is-info {
	color: color-mix(in oklch, var(--efs-white) 88%, var(--efs-info) 12%);
}

.efs-wizard-footer {
	padding-top: var(--efs-space-s);
	border-top: 1px solid var(--efs-wizard-border);
}

.efs-bricks-wizard .button,
.efs-bricks-wizard .button.button-primary,
.efs-bricks-wizard .button.button-secondary {
	border-radius: var(--efs-radius);
}

.efs-wizard-next--validating {
	position: relative;
	color: transparent !important;
	pointer-events: none;
}

.efs-wizard-next--validating::before,
.efs-wizard-next--loading::before {
	content: '';
	position: absolute;
	left: 50%;
	top: 50%;
	width: 16px;
	height: 16px;
	margin-left: -8px;
	margin-top: -8px;
	border: 2px solid currentColor;
	border-top-color: transparent;
	border-radius: 50%;
	animation: efs-wizard-spin 0.6s linear infinite;
	color: var(--efs-white);
}

.efs-wizard-next--loading {
	position: relative;
	color: transparent !important;
	pointer-events: none;
}

@keyframes efs-wizard-spin {
	to {
		transform: rotate(360deg);
	}
}

/* Full-viewport overlay: high z-index and opaque backdrop so wizard content doesn’t show through */
.efs-wizard-progress {
	position: fixed;
	inset: 0;
	background: color-mix(in oklch, var(--efs-base-ultra-dark) 98%, transparent);
	z-index: 999999;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	padding: var(--efs-space-l);
	overflow: auto;
}

.efs-wizard-progress[hidden],
.efs-wizard-banner[hidden] {
	display: none !important;
}

.efs-wizard-progress__panel[hidden] {
	display: none !important;
}

.efs-headless-screen[hidden] {
	display: none !important;
}

/* When showing success/failure result: only the result card is visible, no progress UI */
.efs-wizard-progress.is-showing-result .efs-wizard-progress__minimize {
	display: none !important;
}

.efs-wizard-progress__panel {
	width: min(720px, 100%);
	background: var(--efs-base);
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	padding: 32px;
	display: flex;
	flex-direction: column;
	gap: var(--efs-space-m);
}

.efs-wizard-progress__panel h3 {
	color: var(--efs-white);
	font-size: 1.25rem;
	font-weight: 600;
	margin: 0 0 var(--efs-space-xs) 0;
}

.efs-wizard-progress__minimize {
	position: absolute;
	top: var(--efs-space-l);
	right: var(--efs-space-l);
	z-index: 1;
}

.efs-wizard-progress__percent {
	font-size: 28px;
	font-weight: 600;
	color: var(--efs-primary);
}

.efs-wizard-progress__status,
.efs-wizard-progress__items {
	color: color-mix(in oklch, var(--efs-white) 68%, transparent);
}

.efs-wizard-progress__panel .efs-steps {
	list-style: none;
	padding: 0;
	margin: 0;
	display: flex;
	flex-direction: column;
	gap: var(--efs-space-xs);
}

.efs-wizard-progress__panel .efs-steps li {
	position: relative;
	padding: var(--efs-space-s) var(--efs-space-m);
	padding-inline-end: calc(var(--efs-space-m) + 24px);
	border-radius: var(--efs-radius);
	background: var(--efs-base-dark);
	border-left: 3px solid var(--efs-border-color-light);
	color: color-mix(in oklch, var(--efs-white) 78%, transparent);
	font-size: 13px;
}

.efs-wizard-progress__panel .efs-steps li.is-complete {
	background: color-mix(in oklch, var(--efs-success) 12%, transparent);
	border-left-color: var(--efs-success);
}

.efs-wizard-progress__panel .efs-steps li.is-active {
	background: color-mix(in oklch, var(--efs-primary) 14%, transparent);
	border-left-color: var(--efs-primary);
	position: relative;
}

/* Active step: pulse dot (no font/unicode) */
.efs-wizard-progress__panel .efs-steps li.is-active::after {
	content: '';
	position: absolute;
	inset-inline-end: var(--efs-space-m);
	top: 50%;
	transform: translateY(-50%);
	width: 8px;
	height: 8px;
	border-radius: 50%;
	background: var(--efs-primary);
	animation: efs-step-pulse 1.2s ease-in-out infinite;
}

@keyframes efs-step-pulse {

	0%,
	100% {
		opacity: 1;
	}

	50% {
		opacity: 0.4;
	}
}

.efs-wizard-banner {
	position: sticky;
	top: 32px;
	z-index: 50;
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: var(--efs-space-s);
	padding: var(--efs-space-s) var(--efs-space-m);
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	background: color-mix(in oklch, var(--efs-base-dark) 84%, var(--efs-base-ultra-dark));
}

.efs-wizard-progress-chip {
	display: inline-flex;
	align-items: center;
	gap: 8px;
	padding: 8px 12px;
	border-radius: var(--efs-radius);
	border: 1px solid color-mix(in oklch, var(--efs-primary) 65%, transparent);
	background: color-mix(in oklch, var(--efs-primary) 14%, transparent);
	cursor: pointer;
}

.efs-wizard-progress-chip__icon {
	display: inline-flex;
	width: 16px;
	height: 16px;
	align-items: center;
	justify-content: center;
	color: var(--efs-primary);
}

.efs-wizard-progress-chip__icon::before {
	content: '';
	width: 10px;
	height: 10px;
	border-radius: 50%;
	background: currentColor;
	box-shadow: 0 0 0 4px color-mix(in oklch, var(--efs-primary) 26%, transparent);
}

.efs-wizard-progress-chip__text {
	font-size: 13px;
	font-weight: 500;
	color: var(--efs-white);
}

.efs-wizard-result {
	padding: var(--efs-space-l);
	border: 1px solid var(--efs-wizard-border);
	border-radius: var(--efs-radius);
	text-align: center;
	display: grid;
	gap: var(--efs-space-m);
	background: color-mix(in oklch, var(--efs-base-dark) 88%, var(--efs-base-ultra-dark));
	max-width: min(480px, 100%);
}

.efs-wizard-result[hidden] {
	display: none !important;
}

.efs-wizard-result.is-success {
	border-color: color-mix(in oklch, var(--efs-wizard-success) 55%, transparent);
	background: color-mix(in oklch, var(--efs-wizard-success) 10%, var(--efs-base-dark));
}

.efs-wizard-result.is-success .efs-wizard-result__title,
.efs-wizard-result.is-success [data-efs-result-title] {
	color: var(--efs-wizard-success);
}

.efs-wizard-result.is-error {
	border-color: color-mix(in oklch, var(--efs-wizard-danger) 55%, transparent);
	background: color-mix(in oklch, var(--efs-wizard-danger) 12%, var(--efs-base-dark));
}

.efs-wizard-result.is-error .efs-wizard-result__title,
.efs-wizard-result.is-error [data-efs-result-title] {
	color: var(--efs-wizard-danger);
	font-weight: 600;
}

.efs-wizard-result__icon {
	font-size: 48px;
	line-height: 1;
	font-weight: 600;
}

.efs-wizard-result.is-success .efs-wizard-result__icon::before {
	content: '✓';
	color: var(--efs-wizard-success);
}

.efs-wizard-result.is-error .efs-wizard-result__icon::before {
	content: '✗';
	color: var(--efs-wizard-danger);
}

/* Pre-flight checks */
.efs-preflight {
	margin-bottom: var(--efs-space-m);
	padding-bottom: var(--efs-space-m);
	border-bottom: 1px solid var(--efs-wizard-border);
}

.efs-preflight__loading {
	display: inline-flex;
	align-items: center;
	gap: var(--efs-space-s);
	padding: var(--efs-space-s) var(--efs-space-m);
	background: var(--efs-base-ultra-dark);
	border: 1px solid var(--efs-primary);
	border-radius: var(--efs-radius);
	color: var(--efs-primary);
	font-size: 14px;
}

.efs-preflight__loading[hidden] {
	display: none !important;
}

.efs-preflight__results {
	display: flex;
	flex-direction: column;
	gap: 0;
}

.efs-preflight__results[hidden] {
	display: none !important;
}

.efs-preflight__row {
	display: flex;
	align-items: flex-start;
	gap: var(--efs-space-m);
	padding: var(--efs-space-s) 0;
	border-bottom: 1px solid var(--efs-wizard-border);
}

.efs-preflight__row:last-child {
	border-bottom: none;
}

.efs-preflight__badge {
	flex-shrink: 0;
	display: inline-flex;
	align-items: center;
	border-radius: 3px;
	font-size: 11px;
	font-weight: 600;
	padding: 2px 7px;
	text-transform: uppercase;
	letter-spacing: 0.03em;
}

.efs-preflight__badge--ok {
	background: #d7f0d7;
	color: #1a6b1a;
}

.efs-preflight__badge--warning {
	background: #fff3cd;
	color: #856404;
}

.efs-preflight__badge--error {
	background: #fce8e8;
	color: #d63638;
}

.efs-preflight__badge--info {
	background: #f0f0f1;
	color: #50575e;
}

.efs-preflight__row-content {
	display: flex;
	flex-direction: column;
	gap: 2px;
	flex: 1;
}

.efs-preflight__hint {
	font-size: 11px;
	color: #777;
	line-height: 1.4;
}

.efs-preflight__bar {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: var(--efs-space-s) var(--efs-space-m);
	border-radius: var(--efs-radius);
	border: 1px solid var(--efs-wizard-border);
	background: color-mix(in oklch, var(--efs-base-dark) 70%, var(--efs-base-ultra-dark));
	margin-top: var(--efs-space-s);
	font-size: 13px;
	font-weight: 500;
}

.efs-preflight__bar--warn {
	border-color: color-mix(in oklch, var(--efs-wizard-warning) 55%, transparent);
	background: color-mix(in oklch, var(--efs-wizard-warning) 8%, var(--efs-base-dark));
	color: var(--efs-wizard-warning);
}

.efs-preflight__bar--error {
	border-color: color-mix(in oklch, var(--efs-wizard-danger) 55%, transparent);
	background: color-mix(in oklch, var(--efs-wizard-danger) 10%, var(--efs-base-dark));
	color: var(--efs-wizard-danger);
}

.efs-preflight__actions {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: var(--efs-space-m);
	margin-top: var(--efs-space-s);
}

.efs-preflight__actions[hidden] {
	display: none !important;
}

.efs-preflight__override {
	display: flex;
	align-items: center;
	gap: var(--efs-space-s);
	font-size: 13px;
	cursor: pointer;
}

.efs-preflight__override[hidden] {
	display: none !important;
}

.efs-preflight__recheck {
	margin-left: auto;
}

@media (max-width: 960px) {
	.efs-wizard-steps {
		grid-template-columns: repeat(2, minmax(0, 1fr));
	}
}

@media (max-width: 782px) {
	.efs-wizard-step {
		padding: var(--efs-space-s);
	}

	.efs-wizard-step__label {
		font-size: 12px;
	}

	.efs-wizard-panel {
		padding: var(--efs-space-m);
	}

	.efs-wizard-summary {
		grid-template-columns: 1fr;
		gap: var(--efs-space-m);
	}

	.efs-wizard-progress__minimize {
		top: var(--efs-space-s);
		right: var(--efs-space-s);
	}
}